{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/enderkalem/si_app%20copy/src/supabaseClient.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = 'https://beegwfvdcxwlxjrffrki.supabase.co';  // Replace with your URL\nconst supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJlZWd3ZnZkY3h3bHhqcmZmcmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1OTkzNDYsImV4cCI6MjA2ODE3NTM0Nn0.Tz3XhM8ZCFUH_sHbdqVDCxBfvZVjKx7jDafQmtlzvo0';                  // Replace with your public key\n\nexport const supabase = createClient(supabaseUrl, supabaseKey);\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,4CAA6C,wBAAwB;AACzF,MAAM,cAAc,oNAAqO,+BAA+B;AAEjR,MAAM,WAAW,IAAA,iKAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///Users/enderkalem/si_app%20copy/pages/payment-success.js"],"sourcesContent":["// /pages/payment-success.js\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { supabase } from \"../src/supabaseClient\";\n\nexport default function PaymentSuccess() {\n  const router = useRouter();\n  const [isRefreshing, setIsRefreshing] = useState(true);\n  const [retryCount, setRetryCount] = useState(0);\n  const MAX_RETRIES = 5;\n \n  useEffect(() => {\n  const refreshSessionAndCheck = async () => {\n    try {\n      console.log(`üîÑ Attempt ${retryCount + 1}/${MAX_RETRIES}`);\n      \n      // Refresh auth session\n      const { data: { session }, error: sessionError } = \n        await supabase.auth.refreshSession();\n      \n      if (sessionError) throw sessionError;\n\n      const authPremium = session?.user?.user_metadata?.is_premium === true;\n      console.log('üìã Auth premium:', authPremium);\n\n      // ‚úÖ NEW: Also check profile table\n      const { data: profile, error: profileError } = await supabase\n        .from('profiles')\n        .select('is_premium')\n        .eq('id', session.user.id)\n        .single();\n\n      if (profileError) {\n        console.warn('‚ö†Ô∏è Profile check failed:', profileError);\n      }\n\n      const profilePremium = profile?.is_premium === true;\n      console.log('üíæ Profile premium:', profilePremium);\n      \n      const isPremium = authPremium || profilePremium;\n      \n      if (isPremium) {\n        console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');\n        console.log('üéâ PREMIUM STATUS CONFIRMED!');\n        console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');\n        setIsRefreshing(false);\n        \n        setTimeout(() => {\n          router.push(\"/?showCard=true\");\n        }, 2000);\n      } else {\n        console.log('‚è≥ Not premium yet, retrying...');\n        \n        if (retryCount < MAX_RETRIES) {\n          setTimeout(() => {\n            setRetryCount(prev => prev + 1);\n          }, 3000);\n        } else {\n          console.log('‚ö†Ô∏è Max retries reached');\n          setIsRefreshing(false);\n          setTimeout(() => {\n            router.push(\"/?showCard=true\");\n          }, 2000);\n        }\n      }\n    } catch (error) {\n      console.error('‚ùå Error:', error);\n      setIsRefreshing(false);\n      setTimeout(() => {\n        router.push(\"/\");\n      }, 3000);\n    }\n  };\n\n  refreshSessionAndCheck();\n}, [router, retryCount]);\n\n  return (\n    <div style={{ \n      textAlign: \"center\", \n      padding: 40,\n      minHeight: \"100vh\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"center\",\n      alignItems: \"center\"\n    }}>\n      <div style={{ fontSize: \"64px\", marginBottom: \"20px\" }}>\n        {isRefreshing ? \"üîÑ\" : \"‚úÖ\"}\n      </div>\n      <h1>Payment Successful!</h1>\n      <p>\n        {isRefreshing \n          ? \"Activating your premium features...\" \n          : \"Premium features unlocked! Redirecting...\"\n        }\n      </p>\n      {isRefreshing && retryCount > 0 && (\n        <p style={{ fontSize: \"14px\", color: \"#666\", marginTop: \"10px\" }}>\n          Checking status... ({retryCount}/{MAX_RETRIES})\n        </p>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;AAC5B;AACA;AACA;;;;;AAEe,SAAS;IACtB,MAAM,SAAS,IAAA,oJAAS;IACxB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+GAAQ,EAAC;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+GAAQ,EAAC;IAC7C,MAAM,cAAc;IAEpB,IAAA,gHAAS,EAAC;QACV,MAAM,yBAAyB;YAC7B,IAAI;gBACF,QAAQ,GAAG,CAAC,CAAC,WAAW,EAAE,aAAa,EAAE,CAAC,EAAE,aAAa;gBAEzD,uBAAuB;gBACvB,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,OAAO,YAAY,EAAE,GAC9C,MAAM,0IAAQ,CAAC,IAAI,CAAC,cAAc;gBAEpC,IAAI,cAAc,MAAM;gBAExB,MAAM,cAAc,SAAS,MAAM,eAAe,eAAe;gBACjE,QAAQ,GAAG,CAAC,oBAAoB;gBAEhC,kCAAkC;gBAClC,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,0IAAQ,CAC1D,IAAI,CAAC,YACL,MAAM,CAAC,cACP,EAAE,CAAC,MAAM,QAAQ,IAAI,CAAC,EAAE,EACxB,MAAM;gBAET,IAAI,cAAc;oBAChB,QAAQ,IAAI,CAAC,4BAA4B;gBAC3C;gBAEA,MAAM,iBAAiB,SAAS,eAAe;gBAC/C,QAAQ,GAAG,CAAC,uBAAuB;gBAEnC,MAAM,YAAY,eAAe;gBAEjC,IAAI,WAAW;oBACb,QAAQ,GAAG,CAAC;oBACZ,QAAQ,GAAG,CAAC;oBACZ,QAAQ,GAAG,CAAC;oBACZ,gBAAgB;oBAEhB,WAAW;wBACT,OAAO,IAAI,CAAC;oBACd,GAAG;gBACL,OAAO;oBACL,QAAQ,GAAG,CAAC;oBAEZ,IAAI,aAAa,aAAa;wBAC5B,WAAW;4BACT,cAAc,CAAA,OAAQ,OAAO;wBAC/B,GAAG;oBACL,OAAO;wBACL,QAAQ,GAAG,CAAC;wBACZ,gBAAgB;wBAChB,WAAW;4BACT,OAAO,IAAI,CAAC;wBACd,GAAG;oBACL;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,YAAY;gBAC1B,gBAAgB;gBAChB,WAAW;oBACT,OAAO,IAAI,CAAC;gBACd,GAAG;YACL;QACF;QAEA;IACF,GAAG;QAAC;QAAQ;KAAW;IAErB,qBACE,qKAAC;QAAI,OAAO;YACV,WAAW;YACX,SAAS;YACT,WAAW;YACX,SAAS;YACT,eAAe;YACf,gBAAgB;YAChB,YAAY;QACd;;0BACE,qKAAC;gBAAI,OAAO;oBAAE,UAAU;oBAAQ,cAAc;gBAAO;0BAClD,eAAe,OAAO;;;;;;0BAEzB,qKAAC;0BAAG;;;;;;0BACJ,qKAAC;0BACE,eACG,wCACA;;;;;;YAGL,gBAAgB,aAAa,mBAC5B,qKAAC;gBAAE,OAAO;oBAAE,UAAU;oBAAQ,OAAO;oBAAQ,WAAW;gBAAO;;oBAAG;oBAC3C;oBAAW;oBAAE;oBAAY;;;;;;;;;;;;;AAKxD","debugId":null}}]
}